import{G as e,d as r,H as t,ak as n,h as o,y as a,u as i,aa as s,an as c,a5 as d,M as l,k as u,ao as w,ap as h,aq as m}from"./assets/index-DUqEvd1Q.js";import{x as p,a as g}from"./xterm-BkZOsaGq.js";import"./ace-Fk63Tb3T.js";function f(r){return e({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"4 17 10 11 4 5"},child:[]},{tag:"line",attr:{x1:"12",y1:"19",x2:"20",y2:"19"},child:[]}]})(r)}const b=new TextEncoder,k=()=>{const e=r(null),k=r(null),x=r(null),{sharedDir:v}=t(),{colorMode:y}=n(),[E,T]=o(null),[j,D]=o(null),[L,S]=o(!1),F={background:"dark"===y?"#2D3748":"white",foreground:"dark"===y?"#E2E8F0":"#2D3748",cursor:"dark"===y?"rgba(255, 255, 255, 0.8)":"rgba(0, 0, 0, 0.8)",selectionBackground:"dark"===y?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.2)"};a((()=>{j&&(j.options.theme=F)}),[y]),a((()=>{if(!L)return;const r=()=>{x.current?.fit()};return(async()=>{try{await w({module:h,sdkUrl:`${location.origin}/sdk/index.mjs`});const t=new p.Terminal({cursorBlink:!0,convertEol:!0,fontFamily:'"Fira Code", monospace',fontSize:13,theme:F});D(t);const n=new g.FitAddon;t.loadAddon(n),t.open(e.current),n.fit(),t.focus(),t.element.style.padding="16px";const o=await m.fromRegistry("sharrattj/bash"),a=await o.entrypoint.run({args:["-c",'echo "root:x:0:0:root:/root:/bin/bash" > /etc/passwd && echo "runner" > /etc/hostname && echo "127.0.0.1 runner" >> /etc/hosts && bash'],mount:{"/home":v},cwd:"/home",env:{HOME:"/home",PS1:"\\u@runner:\\w\\$ "}});W(a,t),T(a),k.current=t,x.current=n,window.addEventListener("resize",r)}catch(t){k.current?.writeln(`\r\n[31mError: ${t.message}[0m\r\n`)}})(),()=>{k.current?.dispose(),x.current?.dispose(),window.removeEventListener("resize",r)}}),[L,v]);const W=(e,r)=>{let t=e.stdin?.getWriter();r.onData((e=>{let n=r.buffer.active.getLine(r.buffer.active.cursorY)?.translateToString(!0).trim();n=n.replace(/^bash-\d+\.\d+#\s*/,""),"clear"===n?(r.clear(),t?.write(b.encode("")),t?.write(b.encode("\n"))):t?.write(b.encode(e))})),e.stdout.pipeTo(new WritableStream({write:e=>{const t=(new TextDecoder).decode(e);r.write(t)}})).catch((e=>{})),e.stderr.pipeTo(new WritableStream({write:e=>{const t=(new TextDecoder).decode(e);r.write(t)}})).catch((e=>{}))};return i(u,{children:L?i(l,{ref:e,style:{width:"100%",height:"350px",overflowY:"auto"},borderRadius:"lg",overflow:"clip"}):i(s,{direction:"row",w:"100%",h:"300px",align:"center",justify:"center",children:i(c,{onClick:()=>S(!0),children:[i(d,{as:f,mr:2}),"Load Terminal"]})})})};export{k as default};
